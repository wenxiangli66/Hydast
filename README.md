# HyDaST: Mortality Risk Prediction via EHR-Hypergraph and Dual-Scale Temporal Pattern Extraction

This repository contains the implementation of HyDaST model for **patient mortality prediction**.  
It leverages PyTorch, PyTorch Geometric, and large language models (via the OpenAI API) to process medical event data and learn meaningful patient representations.

---

## 1. Environment and Dependencies

The core environment versions used in this project are:

- `torch==1.13.1+cu116`
- `torch_geometric==2.5.3`
- `numpy==1.23.5`
- `openai==1.58.1`

All other dependency details are specified in `requirements.txt`.  
After creating your Python environment (e.g., via `conda` or `venv`), please run:

```bash
pip install -r requirements.txt

If you use the OpenAI API in this project, please configure your API key as an environment variable.

---

## 2. Data and Preprocessed Files

Due to the large size of the **MIMIC dataset**, as well as the **medical event definitions** and **embedding files** generated by large language models, these data are **not** stored directly in this repository.

Instead, we provide them via an external cloud storage link:

- Download link: `(https://drive.google.com/file/d/1_8DWLSCF6Ro5DxR6JTZrSrQzzbc1dR8H/view?usp=sharing)`

After downloading, please replace the corresponding files/directories in this project with the downloaded ones.

In short:

1. Download all files from `(https://drive.google.com/file/d/1_8DWLSCF6Ro5DxR6JTZrSrQzzbc1dR8H/view?usp=sharing)`.
2. Put them into the project directory.
3. Overwrite/replace the existing placeholder files with the downloaded ones.

---

## 3. Running the Model

Once:

1. The environment is set up, and  
2. The MIMIC-related data plus LLM-processed medical event/embedding files have been downloaded and placed in the correct locations,

you can run the main script with:

    python main.py

All training, evaluation, and logging behavior is controlled via the configuration inside `main.py`.

---

## 4. Notes

- Please ensure you have the proper license/access to the MIMIC dataset and have completed any required data use agreements.
- If you encounter path-related errors, double-check that the downloaded data from `xxx` exactly matches the expected directory structure in this repository.
- For more fine-grained configuration or extension, please refer to the source code and comments in `main.py` and related modules.

---
